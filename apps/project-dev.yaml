apiVersion: argoproj.io/v1alpha1
kind: AppProject
metadata:
  name: dev
  namespace: argocd
  labels:
    scope: core
    stack: core
    layer: project
  annotations:
    argocd.argoproj.io/sync-wave: "-30"
spec:
  description: Dev environment project

  sourceRepos:
    - 'https://github.com/keonhoban/mlops-infra-gitops'

  destinations:
    - namespace: '*-dev'
      server: https://kubernetes.default.svc

  clusterResourceWhitelist:
    - group: ""
      kind: PersistentVolume

  orphanedResources:
    warn: true
    ignore:
      - kind: Secret
        name: airflow-dev-tls
      - kind: Secret
        name: fastapi-dev-tls
      - kind: Secret
        name: mlflow-dev-tls

      - kind: Secret
        name: airflow-db-dev-secret
      - kind: Secret
        name: airflow-dev-api-secret-key
      - kind: Secret
        name: airflow-dev-jwt-secret
      - kind: Secret
        name: airflow-fernet-dev-secret
      - kind: Secret
        name: airflow-git-ssh-secret
      - kind: Secret
        name: aws-credentials-secret
      - kind: Secret
        name: fastapi-token-dev-secret
      - kind: Secret
        name: slack-webhook-dev-secret

      - group: bitnami.com
        kind: SealedSecret
        name: airflow-db-dev-secret
      - group: bitnami.com
        kind: SealedSecret
        name: airflow-dev-api-secret-key
      - group: bitnami.com
        kind: SealedSecret
        name: airflow-dev-jwt-secret
      - group: bitnami.com
        kind: SealedSecret
        name: airflow-fernet-dev-secret
      - group: bitnami.com
        kind: SealedSecret
        name: airflow-git-ssh-secret
      - group: bitnami.com
        kind: SealedSecret
        name: aws-credentials-secret
      - group: bitnami.com
        kind: SealedSecret
        name: fastapi-token-dev-secret
      - group: bitnami.com
        kind: SealedSecret
        name: slack-webhook-dev-secret

      - kind: PersistentVolumeClaim
        name: triton-model-repo-pvc

      - kind: Secret
        name: mlflow-db-dev-secret
      - group: bitnami.com
        kind: SealedSecret
        name: mlflow-db-dev-secret

      - kind: Secret
        name: aws-credentials
      - group: bitnami.com
        kind: SealedSecret
        name: aws-credentials

      - kind: ConfigMap
        name: feature-store-resources

      - kind: PersistentVolumeClaim
        name: fastapi-logs-pvc-dev

