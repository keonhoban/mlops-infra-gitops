config:
  # Loki 엔드포인트는 차트가 만드는 서비스명 기준 (아래는 기본값 예)
  clients:
    - url: http://loki:3100/loki/api/v1/push
  positions:
    filename: /run/promtail/positions.yaml
  logLevel: info

  snippets:
    common: |
      pipeline_stages:
        - cri: {}
        - labeldrop: [filename, stream]

extraScrapeConfigs: |
  - job_name: kubernetes-pods
    kubernetes_sd_configs:
      - role: pod
    relabel_configs:
      - source_labels: [__meta_kubernetes_pod_node_name]
        target_label: node
      - source_labels: [__meta_kubernetes_namespace]
        target_label: namespace
      - source_labels: [__meta_kubernetes_pod_name]
        target_label: pod
      - source_labels: [__meta_kubernetes_pod_container_name]
        target_label: container
      - action: replace
        separator: /
        source_labels: [__meta_kubernetes_namespace, __meta_kubernetes_pod_label_app_kubernetes_io_name]
        target_label: app
    pipeline_stages:
      - cri: {}

daemonset:
  enabled: true
